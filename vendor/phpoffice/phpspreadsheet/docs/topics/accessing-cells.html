<html>
      <head>
        <meta charset="UTF-8">
        <title>accessing-cells.md</title>
      </head>
      <body>
        <h1 id="accessing-cells">Accessing cells</h1>
<p>Accessing cells in a Spreadsheet should be pretty straightforward. This
topic lists some of the options to access a cell.</p>
<h2 id="setting-a-cell-value-by-coordinate">Setting a cell value by coordinate</h2>
<p>Setting a cell value by coordinate can be done using the worksheet&#39;s
<code>setCellValue()</code> method.</p>
<pre><code class="lang-php">// Set cell A1 with a string value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A1&#39;, &#39;PhpSpreadsheet&#39;);

// Set cell A2 with a numeric value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A2&#39;, 12345.6789);

// Set cell A3 with a boolean value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A3&#39;, TRUE);

// Set cell A4 with a formula
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(
    &#39;A4&#39;,
    &#39;=IF(A3, CONCATENATE(A1, &quot; &quot;, A2), CONCATENATE(A2, &quot; &quot;, A1))&#39;
);
</code></pre>
<p>Alternatively, you can retrieve the cell object, and then call the
cellâ€™s <code>setValue()</code> method:</p>
<pre><code class="lang-php">$spreadsheet-&gt;getActiveSheet()
    -&gt;getCell(&#39;B8&#39;)
    -&gt;setValue(&#39;Some value&#39;);
</code></pre>
<h3 id="creating-a-new-cell">Creating a new Cell</h3>
<p>If you make a call to <code>getCell()</code>, and the cell doesn&#39;t already exist, then
PhpSpreadsheet will (by default) create the cell for you. If you don&#39;t want
to create a new cell, then you can pass a second argument of false, and then
<code>getCell()</code> will return a null if the cell doesn&#39;t exist.</p>
<h3 id="beware-cells-assigned-to-variables-as-a-detached-reference">BEWARE: Cells assigned to variables as a Detached Reference</h3>
<p>As an &quot;in-memory&quot; model, PHPSpreadsheet can be very demanding of memory,
particularly when working with large spreadsheets. One technique used to
reduce this memory overhead is cell caching, so cells are actually
maintained in a collection that may or may not be held in memory while you
are working with the spreadsheet. Because of this, a call to <code>getCell()</code>
(or any similar method) returns the cell data, and a pointer to the collection.
While this is not normally an issue, it can become significant
if you assign the result of a call to <code>getCell()</code> to a variable. Any
subsequent calls to retrieve other cells will unset that pointer, although
the cell object will still retain its data values.</p>
<p>What does this mean? Consider the following code:</p>
<pre><code>$spreadSheet = new Spreadsheet();
$workSheet = $spreadSheet-&gt;getActiveSheet();

// Set details for the formula that we want to evaluate, together with any data on which it depends
$workSheet-&gt;fromArray(
    [1, 2, 3],
    null,
    &#39;A1&#39;
);

$cellC1 = $workSheet-&gt;getCell(&#39;C1&#39;);
echo &#39;Value: &#39;, $cellC1-&gt;getValue(), &#39;; Address: &#39;, $cellC1-&gt;getCoordinate(), PHP_EOL;

$cellA1 = $workSheet-&gt;getCell(&#39;A1&#39;);
echo &#39;Value: &#39;, $cellA1-&gt;getValue(), &#39;; Address: &#39;, $cellA1-&gt;getCoordinate(), PHP_EOL;

echo &#39;Value: &#39;, $cellC1-&gt;getValue(), &#39;; Address: &#39;, $cellC1-&gt;getCoordinate(), PHP_EOL;
</code></pre><p>The call to <code>getCell(&#39;C1&#39;)</code> returns the cell at <code>C1</code> containing its value (<code>3</code>),
together with its link to the collection (used to identify its
address/coordinate <code>C1</code>). The subsequent call to access cell <code>A1</code>
modifies the value of <code>$cellC1</code>, detaching its link to the collection.</p>
<p>So when we try to display the value and address a second time, we can display
its value, but trying to display its address/coordinate will throw an
exception because that link has been set to null.</p>
<p><strong>Note:</strong> There are some internal methods that will fetch other cells from the
collection, and this too will detach the link to the collection from any cell
that you might have assigned to a variable.</p>
<h2 id="excel-datatypes">Excel DataTypes</h2>
<p>MS Excel supports 7 basic datatypes:</p>
<ul>
<li>string</li>
<li>number</li>
<li>boolean</li>
<li>null</li>
<li>formula</li>
<li>error</li>
<li>Inline (or rich text) string</li>
</ul>
<p>By default, when you call the worksheet&#39;s <code>setCellValue()</code> method or the
cell&#39;s <code>setValue()</code> method, PhpSpreadsheet will use the appropriate
datatype for PHP nulls, booleans, floats or integers; or cast any string
data value that you pass to the method into the most appropriate
datatype, so numeric strings will be cast to numbers, while string
values beginning with <code>=</code> will be converted to a formula. Strings that
aren&#39;t numeric, or that don&#39;t begin with a leading <code>=</code> will be treated
as genuine string values.</p>
<p>This &quot;conversion&quot; is handled by a cell &quot;value binder&quot;, and you can write
custom &quot;value binders&quot; to change the behaviour of these &quot;conversions&quot;.
The standard PhpSpreadsheet package also provides an &quot;advanced value
binder&quot; that handles a number of more complex conversions, such as
converting strings with a fractional format like &quot;3/4&quot; to a number value
(0.75 in this case) and setting an appropriate &quot;fraction&quot; number format
mask. Similarly, strings like &quot;5%&quot; will be converted to a value of 0.05,
and a percentage number format mask applied, and strings containing
values that look like dates will be converted to Excel serialized
datetimestamp values, and a corresponding mask applied. This is
particularly useful when loading data from csv files, or setting cell
values from a database.</p>
<p>Formats handled by the advanced value binder include:</p>
<ul>
<li>TRUE or FALSE (dependent on locale settings) are converted to booleans.</li>
<li>Numeric strings identified as scientific (exponential) format are
converted to numbers.</li>
<li>Fractions and vulgar fractions are converted to numbers, and
an appropriate number format mask applied.</li>
<li>Percentages are converted
to numbers, divided by 100, and an appropriate number format mask
applied.</li>
<li>Dates and times are converted to Excel timestamp values
(numbers), and an appropriate number format mask applied.</li>
<li>When strings contain a newline character (<code>\n</code>), then the cell styling is
set to wrap.</li>
</ul>
<p>You can read more about value binders later in this section of the
documentation.</p>
<h3 id="setting-a-formula-in-a-cell">Setting a formula in a Cell</h3>
<p>As stated above, if you store a string value with the first character an <code>=</code>
in a cell. PHPSpreadsheet will treat that value as a formula, and then you
can evaluate that formula by calling <code>getCalculatedValue()</code> against the cell.</p>
<p>There may be times though, when you wish to store a value beginning with <code>=</code>
as a string, and that you don&#39;t want PHPSpreadsheet to evaluate as though it
was a formula.</p>
<p>To do this, you need to &quot;escape&quot; the value by setting it as &quot;quoted text&quot;.</p>
<pre><code>// Set cell A4 with a formula
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(
    &#39;A4&#39;,
    &#39;=IF(A3, CONCATENATE(A1, &quot; &quot;, A2), CONCATENATE(A2, &quot; &quot;, A1))&#39;
);
$spreadsheet-&gt;getActiveSheet()-&gt;getCell(&#39;A4&#39;)
    -&gt;getStyle()-&gt;setQuotePrefix(true);
</code></pre><p>Then, even if you ask PHPSpreadsheet to return the calculated value for cell
<code>A4</code>, it will return <code>=IF(A3, CONCATENATE(A1, &quot; &quot;, A2), CONCATENATE(A2, &quot; &quot;, A1))</code>
as a string, and not try to evaluate the formula.</p>
<h3 id="setting-a-date-and-or-time-value-in-a-cell">Setting a date and/or time value in a cell</h3>
<p>Date or time values are held as timestamp in Excel (a simple floating
point value), and a number format mask is used to show how that value
should be formatted; so if we want to store a date in a cell, we need to
calculate the correct Excel timestamp, and set a number format mask.</p>
<pre><code class="lang-php">// Get the current date/time and convert to an Excel date/time
$dateTimeNow = time();
$excelDateValue = \PhpOffice\PhpSpreadsheet\Shared\Date::PHPToExcel( $dateTimeNow );
// Set cell A6 with the Excel date/time value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(
    &#39;A6&#39;,
    $excelDateValue
);
// Set the number format mask so that the excel timestamp will be displayed as a human-readable date/time
$spreadsheet-&gt;getActiveSheet()-&gt;getStyle(&#39;A6&#39;)
    -&gt;getNumberFormat()
    -&gt;setFormatCode(
        \PhpOffice\PhpSpreadsheet\Style\NumberFormat::FORMAT_DATE_DATETIME
    );
</code></pre>
<h3 id="setting-a-number-with-leading-zeroes">Setting a number with leading zeroes</h3>
<p>By default, PhpSpreadsheet will automatically detect the value type and
set it to the appropriate Excel numeric datatype. This type conversion
is handled by a value binder, as described in the section of this
document entitled &quot;Using value binders to facilitate data entry&quot;.</p>
<p>Numbers don&#39;t have leading zeroes, so if you try to set a numeric value
that does have leading zeroes (such as a telephone number) then these
will be normally be lost as the value is cast to a number, so
&quot;01513789642&quot; will be displayed as 1513789642.</p>
<p>There are two ways you can force PhpSpreadsheet to override this
behaviour.</p>
<p>Firstly, you can set the datatype explicitly as a string so that it is
not converted to a number.</p>
<pre><code class="lang-php">// Set cell A8 with a numeric value, but tell PhpSpreadsheet it should be treated as a string
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValueExplicit(
    &#39;A8&#39;,
    &quot;01513789642&quot;,
    \PhpOffice\PhpSpreadsheet\Cell\DataType::TYPE_STRING
);
</code></pre>
<p>Alternatively, you can use a number format mask to display the value
with leading zeroes.</p>
<pre><code class="lang-php">// Set cell A9 with a numeric value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A9&#39;, 1513789642);
// Set a number format mask to display the value as 11 digits with leading zeroes
$spreadsheet-&gt;getActiveSheet()-&gt;getStyle(&#39;A9&#39;)
    -&gt;getNumberFormat()
    -&gt;setFormatCode(
        &#39;00000000000&#39;
    );
</code></pre>
<p>With number format masking, you can even break up the digits into groups
to make the value more easily readable.</p>
<pre><code class="lang-php">// Set cell A10 with a numeric value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A10&#39;, 1513789642);
// Set a number format mask to display the value as 11 digits with leading zeroes
$spreadsheet-&gt;getActiveSheet()-&gt;getStyle(&#39;A10&#39;)
    -&gt;getNumberFormat()
    -&gt;setFormatCode(
        &#39;0000-000-0000&#39;
    );
</code></pre>
<p><img src="./images/07-simple-example-1.png" alt="07-simple-example-1.png"></p>
<p><strong>Note:</strong> that not all complex format masks such as this one will work
when retrieving a formatted value to display &quot;on screen&quot;, or for certain
writers such as HTML or PDF, but it will work with the true spreadsheet
writers (Xlsx and Xls).</p>
<h2 id="setting-a-range-of-cells-from-an-array">Setting a range of cells from an array</h2>
<p>It is also possible to set a range of cell values in a single call by
passing an array of values to the <code>fromArray()</code> method.</p>
<pre><code class="lang-php">$arrayData = [
    [NULL, 2010, 2011, 2012],
    [&#39;Q1&#39;,   12,   15,   21],
    [&#39;Q2&#39;,   56,   73,   86],
    [&#39;Q3&#39;,   52,   61,   69],
    [&#39;Q4&#39;,   30,   32,    0],
];
$spreadsheet-&gt;getActiveSheet()
    -&gt;fromArray(
        $arrayData,  // The data to set
        NULL,        // Array values with this value will not be set
        &#39;C3&#39;         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
</code></pre>
<p><img src="./images/07-simple-example-2.png" alt="07-simple-example-2.png"></p>
<p>If you pass a 2-d array, then this will be treated as a series of rows
and columns. A 1-d array will be treated as a single row, which is
particularly useful if you&#39;re fetching an array of data from a database.</p>
<pre><code class="lang-php">$rowArray = [&#39;Value1&#39;, &#39;Value2&#39;, &#39;Value3&#39;, &#39;Value4&#39;];
$spreadsheet-&gt;getActiveSheet()
    -&gt;fromArray(
        $rowArray,   // The data to set
        NULL,        // Array values with this value will not be set
        &#39;C3&#39;         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
</code></pre>
<p><img src="./images/07-simple-example-3.png" alt="07-simple-example-3.png"></p>
<p>If you have a simple 1-d array, and want to write it as a column, then
the following will convert it into an appropriately structured 2-d array
that can be fed to the <code>fromArray()</code> method:</p>
<pre><code class="lang-php">$rowArray = [&#39;Value1&#39;, &#39;Value2&#39;, &#39;Value3&#39;, &#39;Value4&#39;];
$columnArray = array_chunk($rowArray, 1);
$spreadsheet-&gt;getActiveSheet()
    -&gt;fromArray(
        $columnArray,   // The data to set
        NULL,           // Array values with this value will not be set
        &#39;C3&#39;            // Top left coordinate of the worksheet range where
                        //    we want to set these values (default is A1)
    );
</code></pre>
<p><img src="./images/07-simple-example-4.png" alt="07-simple-example-4.png"></p>
<h2 id="retrieving-a-cell-value-by-coordinate">Retrieving a cell value by coordinate</h2>
<p>To retrieve the value of a cell, the cell should first be retrieved from
the worksheet using the <code>getCell()</code> method. A cell&#39;s value can be read
using the <code>getValue()</code> method.</p>
<pre><code class="lang-php">// Get the value from cell A1
$cellValue = $spreadsheet-&gt;getActiveSheet()-&gt;getCell(&#39;A1&#39;)-&gt;getValue();
</code></pre>
<p>This will retrieve the raw, unformatted value contained in the cell.</p>
<p>If a cell contains a formula, and you need to retrieve the calculated
value rather than the formula itself, then use the cell&#39;s
<code>getCalculatedValue()</code> method. This is further explained in
<a href="./calculation-engine.md">the calculation engine</a>.</p>
<pre><code class="lang-php">// Get the value from cell A4
$cellValue = $spreadsheet-&gt;getActiveSheet()-&gt;getCell(&#39;A4&#39;)-&gt;getCalculatedValue();
</code></pre>
<p>Alternatively, if you want to see the value with any cell formatting
applied (e.g. for a human-readable date or time value), then you can use
the cell&#39;s <code>getFormattedValue()</code> method.</p>
<pre><code class="lang-php">// Get the value from cell A6
$cellValue = $spreadsheet-&gt;getActiveSheet()-&gt;getCell(&#39;A6&#39;)-&gt;getFormattedValue();
</code></pre>
<h2 id="setting-a-cell-value-by-column-and-row">Setting a cell value by column and row</h2>
<p>Setting a cell value by coordinate can be done using the worksheet&#39;s
<code>setCellValueByColumnAndRow()</code> method.</p>
<pre><code class="lang-php">// Set cell A5 with a string value
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1, 5, &#39;PhpSpreadsheet&#39;);
</code></pre>
<p><strong>Note:</strong> that column references start with <code>1</code> for column <code>A</code>.</p>
<h2 id="retrieving-a-cell-value-by-column-and-row">Retrieving a cell value by column and row</h2>
<p>To retrieve the value of a cell, the cell should first be retrieved from
the worksheet using the <code>getCellByColumnAndRow()</code> method. A cellâ€™s value can
be read again using the following line of code:</p>
<pre><code class="lang-php">// Get the value from cell B5
$cellValue = $spreadsheet-&gt;getActiveSheet()-&gt;getCellByColumnAndRow(2, 5)-&gt;getValue();
</code></pre>
<p>If you need the calculated value of a cell, use the following code. This
is further explained in <a href="./calculation-engine.md">the calculation engine</a>.</p>
<pre><code class="lang-php">// Get the value from cell A4
$cellValue = $spreadsheet-&gt;getActiveSheet()-&gt;getCellByColumnAndRow(1, 4)-&gt;getCalculatedValue();
</code></pre>
<h2 id="retrieving-a-range-of-cell-values-to-an-array">Retrieving a range of cell values to an array</h2>
<p>It is also possible to retrieve a range of cell values to an array in a
single call using the <code>toArray()</code>, <code>rangeToArray()</code> or
<code>namedRangeToArray()</code> methods.</p>
<pre><code class="lang-php">$dataArray = $spreadsheet-&gt;getActiveSheet()
    -&gt;rangeToArray(
        &#39;C3:E5&#39;,     // The worksheet range that we want to retrieve
        NULL,        // Value that should be returned for empty cells
        TRUE,        // Should formulas be calculated (the equivalent of getCalculatedValue() for each cell)
        TRUE,        // Should values be formatted (the equivalent of getFormattedValue() for each cell)
        TRUE         // Should the array be indexed by cell row and cell column
    );
</code></pre>
<p>These methods will all return a 2-d array of rows and columns. The
<code>toArray()</code> method will return the whole worksheet; <code>rangeToArray()</code>
will return a specified range or cells; while <code>namedRangeToArray()</code> will
return the cells within a defined <code>named range</code>.</p>
<h2 id="looping-through-cells">Looping through cells</h2>
<h3 id="looping-through-cells-using-iterators">Looping through cells using iterators</h3>
<p>The easiest way to loop cells is by using iterators. Using iterators,
one can use foreach to loop worksheets, rows within a worksheet, and
cells within a row.</p>
<p>Below is an example where we read all the values in a worksheet and
display them in a table.</p>
<pre><code class="lang-php">$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader(&#39;Xlsx&#39;);
$reader-&gt;setReadDataOnly(TRUE);
$spreadsheet = $reader-&gt;load(&quot;test.xlsx&quot;);

$worksheet = $spreadsheet-&gt;getActiveSheet();

echo &#39;&lt;table&gt;&#39; . PHP_EOL;
foreach ($worksheet-&gt;getRowIterator() as $row) {
    echo &#39;&lt;tr&gt;&#39; . PHP_EOL;
    $cellIterator = $row-&gt;getCellIterator();
    $cellIterator-&gt;setIterateOnlyExistingCells(FALSE); // This loops through all cells,
                                                       //    even if a cell value is not set.
                                                       // By default, only cells that have a value
                                                       //    set will be iterated.
    foreach ($cellIterator as $cell) {
        echo &#39;&lt;td&gt;&#39; .
             $cell-&gt;getValue() .
             &#39;&lt;/td&gt;&#39; . PHP_EOL;
    }
    echo &#39;&lt;/tr&gt;&#39; . PHP_EOL;
}
echo &#39;&lt;/table&gt;&#39; . PHP_EOL;
</code></pre>
<p>Note that we have set the cell iterator&#39;s
<code>setIterateOnlyExistingCells()</code> to FALSE. This makes the iterator loop
all cells within the worksheet range, even if they have not been set.</p>
<p>The cell iterator will return a <code>null</code> as the cell value if it is not
set in the worksheet. Setting the cell iterator&#39;s
<code>setIterateOnlyExistingCells()</code> to <code>false</code> will loop all cells in the
worksheet that can be available at that moment. This will create new
cells if required and increase memory usage! Only use it if it is
intended to loop all cells that are possibly available.</p>
<h3 id="looping-through-cells-using-indexes">Looping through cells using indexes</h3>
<p>One can use the possibility to access cell values by column and row
index like <code>[1, 1]</code> instead of <code>&#39;A1&#39;</code> for reading and writing cell values in
loops.</p>
<p><strong>Note:</strong> In PhpSpreadsheet column index and row index are 1-based. That means <code>&#39;A1&#39;</code> ~ <code>[1, 1]</code></p>
<p>Below is an example where we read all the values in a worksheet and
display them in a table.</p>
<pre><code class="lang-php">$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader(&#39;Xlsx&#39;);
$reader-&gt;setReadDataOnly(TRUE);
$spreadsheet = $reader-&gt;load(&quot;test.xlsx&quot;);

$worksheet = $spreadsheet-&gt;getActiveSheet();
// Get the highest row and column numbers referenced in the worksheet
$highestRow = $worksheet-&gt;getHighestRow(); // e.g. 10
$highestColumn = $worksheet-&gt;getHighestColumn(); // e.g &#39;F&#39;
$highestColumnIndex = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::columnIndexFromString($highestColumn); // e.g. 5

echo &#39;&lt;table&gt;&#39; . &quot;\n&quot;;
for ($row = 1; $row &lt;= $highestRow; ++$row) {
    echo &#39;&lt;tr&gt;&#39; . PHP_EOL;
    for ($col = 1; $col &lt;= $highestColumnIndex; ++$col) {
        $value = $worksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue();
        echo &#39;&lt;td&gt;&#39; . $value . &#39;&lt;/td&gt;&#39; . PHP_EOL;
    }
    echo &#39;&lt;/tr&gt;&#39; . PHP_EOL;
}
echo &#39;&lt;/table&gt;&#39; . PHP_EOL;
</code></pre>
<p>Alternatively, you can take advantage of PHP&#39;s &quot;Perl-style&quot; character
incrementors to loop through the cells by coordinate:</p>
<pre><code class="lang-php">$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader(&#39;Xlsx&#39;);
$reader-&gt;setReadDataOnly(TRUE);
$spreadsheet = $reader-&gt;load(&quot;test.xlsx&quot;);

$worksheet = $spreadsheet-&gt;getActiveSheet();
// Get the highest row number and column letter referenced in the worksheet
$highestRow = $worksheet-&gt;getHighestRow(); // e.g. 10
$highestColumn = $worksheet-&gt;getHighestColumn(); // e.g &#39;F&#39;
// Increment the highest column letter
$highestColumn++;

echo &#39;&lt;table&gt;&#39; . &quot;\n&quot;;
for ($row = 1; $row &lt;= $highestRow; ++$row) {
    echo &#39;&lt;tr&gt;&#39; . PHP_EOL;
    for ($col = &#39;A&#39;; $col != $highestColumn; ++$col) {
        echo &#39;&lt;td&gt;&#39; .
             $worksheet-&gt;getCell($col . $row)
                 -&gt;getValue() .
             &#39;&lt;/td&gt;&#39; . PHP_EOL;
    }
    echo &#39;&lt;/tr&gt;&#39; . PHP_EOL;
}
echo &#39;&lt;/table&gt;&#39; . PHP_EOL;
</code></pre>
<p>Note that we can&#39;t use a <code>&lt;=</code> comparison here, because <code>&#39;AA&#39;</code> would match
as <code>&lt;= &#39;B&#39;</code>, so we increment the highest column letter and then loop
while <code>$col !=</code> the incremented highest column.</p>
<h2 id="using-value-binders-to-facilitate-data-entry">Using value binders to facilitate data entry</h2>
<p>Internally, PhpSpreadsheet uses a default
<code>\PhpOffice\PhpSpreadsheet\Cell\IValueBinder</code> implementation
(\PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder) to determine data
types of entered data using a cell&#39;s <code>setValue()</code> method (the
<code>setValueExplicit()</code> method bypasses this check).</p>
<p>Optionally, the default behaviour of PhpSpreadsheet can be modified,
allowing easier data entry. For example, a
<code>\PhpOffice\PhpSpreadsheet\Cell\AdvancedValueBinder</code> class is available.
It automatically converts percentages, number in scientific format, and
dates entered as strings to the correct format, also setting the cell&#39;s
style information. The following example demonstrates how to set the
value binder in PhpSpreadsheet:</p>
<pre><code class="lang-php">/** PhpSpreadsheet */
require_once &#39;src/Boostrap.php&#39;;

// Set value binder
\PhpOffice\PhpSpreadsheet\Cell\Cell::setValueBinder( new \PhpOffice\PhpSpreadsheet\Cell\AdvancedValueBinder() );

// Create new Spreadsheet object
$spreadsheet = new \PhpOffice\PhpSpreadsheet\Spreadsheet();

// ...
// Add some data, resembling some different data types
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A4&#39;, &#39;Percentage value:&#39;);
// Converts the string value to 0.1 and sets percentage cell style
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;B4&#39;, &#39;10%&#39;);

$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;A5&#39;, &#39;Date/time value:&#39;);
// Converts the string value to an Excel datestamp and sets the date format cell style
$spreadsheet-&gt;getActiveSheet()-&gt;setCellValue(&#39;B5&#39;, &#39;21 December 1983&#39;);
</code></pre>
<p><strong>Creating your own value binder is easy.</strong> When advanced value binding
is required, you can implement the
<code>\PhpOffice\PhpSpreadsheet\Cell\IValueBinder</code> interface or extend the
<code>\PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder</code> or
<code>\PhpOffice\PhpSpreadsheet\Cell\AdvancedValueBinder</code> classes.</p>

      </body>
    </html>